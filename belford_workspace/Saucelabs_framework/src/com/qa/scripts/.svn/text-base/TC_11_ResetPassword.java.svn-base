///////////////////Script Info //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Script Name:												ResetPassword
//TestCase Summary: 										Verify that existing user is able to reset the password through Accounts page.
//What the script does/TestCase Description:				Following is what Scripts does
//															1. Calls the Reusable action signin with the username and password in TestData.ini file
//															2. Navigates to Accounts page of the account.
//															3. Calls the reusable action to reset password of the account.
//															2. After the reusable action it make sure that password got reset for account.
//What script(s) should be run before this script:			N/A <br>
//What script(s) should be run after this script:			N/A <br>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

package com.qa.scripts;

import org.testng.annotations.*;
import org.testng.Assert;
import com.qa.Functions.common.CommonUtils;
import com.qa.Functions.webdriver.UIEvents;
import com.qa.ReusableActions.ReusableActions;

public class TC_11_ResetPassword extends SetupScript {
	//This is the test cases to ensure that the user is able to reset the password through accounts page.
	@Test(description="TC_09_Verify that existing user is able to reset the password through Accounts page.", groups="SmokeTest")	
		public void resetPassword() throws Exception {
		
		//This sections calls the reusable action to signin application with the provided username and password
		ReusableActions.accountSignIn(driver, CommonUtils.readIni("TestData.ini","txt_ResetPasswordUser"), CommonUtils.readIni("TestData.ini", "txt_OldPassword"));
			
		//System clicks on the My deals button.
		UIEvents.click(driver, CommonUtils.readIni("Repository.ini", "btn_MyDeals"));
					
		//System clicks on the My Account button.
		UIEvents.click(driver, CommonUtils.readIni("Repository.ini", "btn_MyAccount"));
			
		//System Calls reusable action to reset the password with the provided new and old password.
		ReusableActions.ResetPassword(driver,CommonUtils.readIni("TestData.ini", "txt_OldPassword") , CommonUtils.readIni("TestData.ini", "txt_NewPassword"));
		
		//System is ensuring whether the user is able to reset the password through accounts page.
		Assert.assertNotNull(UIEvents.waitForElement(driver, CommonUtils.readIni("Repository.ini", "msg_PasswordResetMessage")));

		//Setting the password to new password
		String newPassword, oldPassword;
		newPassword= CommonUtils.readIni("TestData.ini", "txt_NewPassword");
		oldPassword=CommonUtils.readIni("TestData.ini", "txt_OldPassword");
	
		
		CommonUtils.writeIni("TestData.ini", "ResetPassword", "txt_OldPassword", newPassword);
		CommonUtils.writeIni("TestData.ini", "ResetPassword", "txt_NewPassword", oldPassword);
		
	}		
		
}