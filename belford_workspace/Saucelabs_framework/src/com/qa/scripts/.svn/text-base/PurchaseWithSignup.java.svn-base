///////////////////Script Info //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Script Name:												PurchaseWithSignup
//TestCase Summary: 										Verify that User is able to Purchase with Signup.
//What the script does/TestCase Description:				Following is what Scripts does
//															1. Calls the Reusable action signup with the username and password in TestData.ini file
//															2. Clicks on the deal object and navigate through the deal purchase flow.
//															3. Ensures that the user is able to see the deals confirmation page.
//What script(s) should be run before this script:			N/A <br>
//What script(s) should be run after this script:			N/A <br>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
package com.qa.scripts;

import org.testng.annotations.*;
import org.testng.Assert;
import com.qa.Functions.common.CommonUtils;
import com.qa.Functions.webdriver.UIEvents;
import com.qa.ReusableActions.ReusableActions;

public class PurchaseWithSignup extends SetupScript {
	//This is the test cases to ensure that the user is able to purchase a deal after sign up.
	@Test(description="Verify that user is able to signup", groups="SmokeTest")	
		public void accountSignIn() throws Exception {
		//This sections calls the reusable action to signin application with the provided username and password
		ReusableActions.accountSignIn(driver, CommonUtils.readIni("TestData.ini", "UserName"), CommonUtils.readIni("TestData.ini", "Password"));
		
		//Click 'Update' button on Refine page
		ReusableActions.RefineFilter(driver, CommonUtils.readIni("TestData.ini", "CITY"), CommonUtils.readIni("TestData.ini", "CATEGORY"));
		
		//System is waiting for seconds specified
		CommonUtils.waitForChangesToReflect(CommonUtils.toInt(CommonUtils.readIni("Environment.ini", "INTERVAL")));
		
		//system clicks on the deal on deals list page.
		UIEvents.click(driver, CommonUtils.readIni("Repository.ini", "obj_Deal"));
		
		//System is waiting for seconds specified
		CommonUtils.waitForChangesToReflect(CommonUtils.toInt(CommonUtils.readIni("Environment.ini", "INTERVAL")));

		//system clicks on buy now button after selecting the deal
		UIEvents.click(driver, CommonUtils.readIni("Repository.ini", "btn_BuyNow"));
		
		//System is waiting for seconds specified
		CommonUtils.waitForChangesToReflect(CommonUtils.toInt(CommonUtils.readIni("Environment.ini", "INTERVAL")));

		//system clicks on buy now button after selecting the deal
		UIEvents.click(driver, CommonUtils.readIni("Repository.ini", "btn_BuyNowButton"));
	
		//System is waiting for seconds specified
		CommonUtils.waitForChangesToReflect(CommonUtils.toInt(CommonUtils.readIni("Environment.ini", "INTERVAL")));
		
		//system ensure that the deal got completed.
		Assert.assertNotNull(UIEvents.getElement(driver, CommonUtils.readIni("Repository.ini", "lnk_PurchaseConfirmationlink")));
		
	}	
	
		
}